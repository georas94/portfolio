{% extends 'base.html.twig' %}

{% block title %}Historique{% endblock %}

{% block body %}
    {% for message in app.flashes('success') %}
        <div class="d-flex justify-content-end">
            <div class="alert text-center" style="background: #4CAF50!important;font-weight: 900 !important;">
                {{ message }}
            </div>
        </div>
    {% endfor %}
    {% for message in app.flashes('error') %}
        <div class="d-flex justify-content-end">
            <div class="alert text-center" style="background: #ff0000!important;font-weight: 900 !important;">
                {{ message }}
            </div>
        </div>
    {% endfor %}

    {% for shift in shifts %}
        <div style="display: flex; margin-bottom: 5em" class="col-md-5 col-xs-12">
            <div style="display: flex;flex-direction: column;justify-content: space-between;">
                <div class="fw-bolder">
                    <div>
                        <div class="card p-2 {{ shift.status == statusEnded ? 'bg-success' : 'bg-warning' }}" style="width: 25rem;height: 33em;">
                            <div class="card-body">
                                <span>Responsable</span>
                                <p class="card-text fw-lighter">{{ shift.employee.lastname ~ ' ' ~ shift.employee.firstname}}</p>
                                <span>Date de création</span>
                                <p class="card-text fw-lighter">{{ shift.createdAt|date("d/m/Y")}}</p>
                                <span>Terminé le</span>
                                <p class="card-text fw-lighter">{{ shift.endedAt ? shift.endedAt|date("d/m/Y H:i:s") : 'En cours'}}</p>
                                <span>Pompe affectée</span>
                                <p class="card-text fw-lighter">{{ shift.pump.id }}</p>
                                <span>Quantité de gasoil de départ</span>
                                <p class="card-text fw-lighter">{{ shift.gasoilQuantityAtStart }}</p>
                                <span>Quantité d'essence de départ</span>
                                <p class="card-text fw-lighter">{{ shift.essenceQuantityAtStart }}</p>
                                <span>Quantité de gasoil en fin de tournée</span>
                                <p class="card-text fw-lighter">{{ shift.gasoilQuantityAtEnd ?? 0 }}</p>
                                <span>Quantité d'essence en fin de tournée</span>
                                <p class="card-text fw-lighter">{{ shift.essenceQuantityAtEnd ?? 0 }}</p>
                            </div>
                        </div>
                        {% if shift.status == statusInProcess %}
                            <div class="d-flex justify-content-center">
                                <a class="mdc-button mdc-button--raised mdc-ripple-upgraded" href="{{ path('app_pump_end', {id: shift.id}) }}">Terminer la tournée</a>
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    {% endfor %}
{% endblock %}
